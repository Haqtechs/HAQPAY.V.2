<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Transfer Money - HaqPay</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="HaqPay">
<link rel="manifest" href="manifest.json">
<link rel="apple-touch-icon" href="https://api.dicebear.com/7.x/identicon/svg?seed=HaqPay&backgroundColor=008037&size=180">
    <style>
        :root{
          --green:#008037;
          --green-strong:#00a84e;
          --bg:#f3f8f5;
          --card:#fff;
          --text:#111;
        }

        body.dark{
          --bg:#0f1a14;
          --card:#15261d;
          --text:#f2f2f2;
        }

        *{box-sizing:border-box}
        body{
          margin:0;
          font-family:Inter,Arial,sans-serif;
          background:var(--bg);
          color:var(--text);
          padding-bottom:70px;
        }

        /* HEADER */
        .header{
          background:var(--green);
          color:#fff;
          padding:16px;
          display:flex;
          align-items:center;
          gap:12px;
          position:sticky;
          top:0;
          z-index:100;
          box-shadow:0 2px 8px rgba(0,0,0,.1);
        }
        .back-btn{
          background:rgba(255,255,255,.15);
          border:none;
          color:#fff;
          width:36px;
          height:36px;
          border-radius:8px;
          cursor:pointer;
          font-size:18px;
          transition:all .2s;
        }
        .header h2{
          margin:0;
          font-size:18px;
          font-weight:700;
          flex:1;
        }
        .icon-btn{
          background:rgba(255,255,255,.15);
          border:none;
          color:#fff;
          width:36px;
          height:36px;
          border-radius:8px;
          cursor:pointer;
          font-size:18px;
        }

        /* TABS */
        .tabs{
          background:var(--card);
          display:flex;
          padding:4px;
          margin:16px;
          border-radius:12px;
          box-shadow:0 2px 6px rgba(0,0,0,.05);
        }
        .tab{
          flex:1;
          background:none;
          border:none;
          padding:12px;
          border-radius:8px;
          font-weight:600;
          cursor:pointer;
          color:#888;
          transition:all .2s;
        }
        .tab.active{
          background:var(--green);
          color:#fff;
        }

        /* SECTION HEADER */
        .section-header{
          padding:20px 16px 12px;
          font-size:16px;
          font-weight:700;
          color:var(--text);
        }

        /* BENEFICIARIES */
        .beneficiaries{
          display:flex;
          gap:12px;
          overflow-x:auto;
          padding:0 16px 16px;
          -webkit-overflow-scrolling:touch;
        }
        .beneficiaries::-webkit-scrollbar{display:none}
        .beneficiary{
          text-align:center;
          min-width:80px;
          cursor:pointer;
        }
        .beneficiary-avatar{
          width:60px;
          height:60px;
          border-radius:50%;
          background:var(--green);
          color:#fff;
          display:flex;
          align-items:center;
          justify-content:center;
          font-size:24px;
          margin:0 auto 8px;
          box-shadow:0 2px 8px rgba(0,128,55,.15);
          transition:all .2s;
        }
        .beneficiary:hover .beneficiary-avatar{
          transform:scale(1.1);
        }
        .beneficiary-name{
          font-size:12px;
          font-weight:600;
          margin-bottom:4px;
        }
        .beneficiary-bank{
          font-size:10px;
          color:#888;
        }

        /* FORM CARD */
        .form-card{
          margin:0 16px 16px;
          background:var(--card);
          border-radius:12px;
          padding:20px;
          box-shadow:0 2px 6px rgba(0,0,0,.05);
        }
        .form-group{
          margin-bottom:20px;
        }
        .form-label{
          display:block;
          font-size:13px;
          font-weight:600;
          margin-bottom:8px;
          color:var(--text);
        }
        .form-select{
          width:100%;
          padding:14px;
          border:2px solid #e0e0e0;
          border-radius:10px;
          font-size:14px;
          background:var(--card);
          color:var(--text);
        }
        .form-select:focus{
          outline:none;
          border-color:var(--green);
        }
        .input-wrapper{
          position:relative;
        }
        .form-input{
          width:100%;
          padding:14px;
          border:2px solid #e0e0e0;
          border-radius:10px;
          font-size:14px;
          background:var(--card);
          color:var(--text);
        }
        .form-input:focus{
          outline:none;
          border-color:var(--green);
        }
        .input-icon{
          position:absolute;
          right:14px;
          top:50%;
          transform:translateY(-50%);
          color:#888;
        }
        .verify-status{
          margin-top:8px;
          padding:10px;
          border-radius:8px;
          font-size:13px;
          display:none;
        }
        .verify-status.loading{
          display:block;
          background:#fff4e6;
          color:#d97706;
        }
        .verify-status.success{
          display:block;
          background:#e6f4ec;
          color:var(--green);
        }
        .verify-status.error{
          display:block;
          background:#fff0f0;
          color:#ff6b6b;
        }
        .account-name{
          font-weight:700;
          font-size:15px;
        }

        /* FEE INFO */
        .fee-info{
          background:rgba(0,128,55,.05);
          padding:12px;
          border-radius:10px;
          margin-top:16px;
        }
        .fee-row{
          display:flex;
          justify-content:space-between;
          padding:6px 0;
          font-size:13px;
        }
        .fee-row.total{
          border-top:1px solid rgba(0,0,0,.1);
          margin-top:8px;
          padding-top:12px;
          font-weight:700;
          font-size:15px;
        }

        /* TRANSFER BUTTON */
        .transfer-btn{
          width:100%;
          background:var(--green);
          color:#fff;
          border:none;
          padding:16px;
          border-radius:12px;
          font-weight:600;
          font-size:16px;
          cursor:pointer;
          transition:all .2s;
        }
        .transfer-btn:hover{background:var(--green-strong)}
        .transfer-btn:active{transform:scale(.98)}
        .transfer-btn:disabled{
          background:#ccc;
          cursor:not-allowed;
        }

        /* BOTTOM NAV */
        .bottom-nav{
          position:fixed;
          bottom:0;
          left:0;
          right:0;
          height:60px;
          background:var(--card);
          display:flex;
          border-top:1px solid rgba(0,0,0,.08);
          box-shadow:0 -2px 10px rgba(0,0,0,.05);
          z-index:100;
        }
        .bn{
          flex:1;
          text-decoration:none;
          color:#666;
          display:flex;
          flex-direction:column;
          align-items:center;
          justify-content:center;
          font-size:11px;
          font-weight:500;
          position:relative;
        }
        .bn::before{
          content:"";
          position:absolute;
          top:0;
          width:0;
          height:3px;
          background:var(--green);
          transition:width .3s;
        }
        .bn.active{color:var(--green)}
        .bn.active::before{width:60%}
        .bn-icon{
          font-size:20px;
          margin-bottom:2px;
        }

        /* MODAL */
        .modal{
          position:fixed;
          inset:0;
          background:rgba(0,0,0,.6);
          display:none;
          align-items:center;
          justify-content:center;
          z-index:1000;
          backdrop-filter:blur(4px);
          padding:20px;
        }
        .modal.show{display:flex}
        .modal-content{
          background:var(--card);
          border-radius:16px;
          width:100%;
          max-width:400px;
          text-align:center;
          box-shadow:0 8px 32px rgba(0,0,0,.2);
          padding:24px;
        }
        .modal-icon{
          font-size:64px;
          margin-bottom:16px;
        }
        .modal-title{
          font-weight:700;
          font-size:20px;
          margin-bottom:12px;
        }
        .modal-text{
          font-size:14px;
          color:#888;
          margin-bottom:8px;
        }
        .modal-detail{
          background:rgba(0,128,55,.05);
          padding:16px;
          border-radius:10px;
          margin:16px 0;
          text-align:left;
        }
        .detail-row{
          display:flex;
          justify-content:space-between;
          padding:8px 0;
          font-size:14px;
        }
        .detail-label{
          color:#888;
        }
        .detail-value{
          font-weight:600;
          text-align:right;
        }

        /* PIN INPUT */
        .pin-inputs{
          display:flex;
          gap:12px;
          justify-content:center;
          margin:20px 0;
        }
        .pin-input{
          width:50px;
          height:50px;
          border:2px solid #e0e0e0;
          border-radius:10px;
          text-align:center;
          font-size:24px;
          font-weight:700;
          background:var(--card);
          color:var(--text);
        }
        .pin-input:focus{
          outline:none;
          border-color:var(--green);
        }

        /* MODAL ACTIONS */
        .modal-actions{
          display:flex;
          gap:10px;
          margin-top:20px;
        }
        .modal-btn{
          flex:1;
          padding:14px;
          border-radius:10px;
          border:none;
          font-weight:600;
          cursor:pointer;
          transition:all .2s;
        }
        .modal-btn.primary{
          background:var(--green);
          color:#fff;
        }
        .modal-btn.secondary{
          background:rgba(0,0,0,.05);
          color:var(--text);
        }

        /* SUCCESS */
        .success-icon{
          width:80px;
          height:80px;
          border-radius:50%;
          background:#e6f4ec;
          color:var(--green);
          display:flex;
          align-items:center;
          justify-content:center;
          font-size:48px;
          margin:0 auto 20px;
          animation:successPop .5s;
        }
        @keyframes successPop{
          0%{transform:scale(0)}
          50%{transform:scale(1.1)}
          100%{transform:scale(1)}
        }

        /* TOAST */
        .toast{
          position:fixed;
          bottom:80px;
          left:50%;
          transform:translateX(-50%) translateY(100px);
          background:var(--card);
          color:var(--text);
          padding:14px 20px;
          border-radius:12px;
          box-shadow:0 4px 16px rgba(0,0,0,.15);
          display:flex;
          align-items:center;
          gap:10px;
          z-index:1001;
          opacity:0;
          transition:all .3s;
          max-width:90%;
          border-left:4px solid var(--green);
        }
        .toast.show{
          transform:translateX(-50%) translateY(0);
          opacity:1;
        }
    </style>
</head>
<body>

    <!-- HEADER -->
    <header class="header">
        <button class="back-btn" id="backBtn">‚Üê</button>
        <h2>Transfer Money</h2>
        <button class="icon-btn" id="historyBtn">üìú</button>
    </header>

    <!-- TABS -->
    <div class="tabs">
        <button class="tab active" onclick="switchTab('bank')">To Bank</button>
        <button class="tab" onclick="switchTab('haqpay')">To HaqPay</button>
    </div>

    <!-- BENEFICIARIES -->
    <div class="section-header">Recent</div>
    <div class="beneficiaries">
        <div class="beneficiary" onclick="selectBeneficiary('Fadipe Precious', 'OPay', '8012345678')">
            <div class="beneficiary-avatar">üë©</div>
            <div class="beneficiary-name">Precious</div>
            <div class="beneficiary-bank">OPay</div>
        </div>
        <div class="beneficiary" onclick="selectBeneficiary('Fashina Khalid', 'UBA', '2034567890')">
            <div class="beneficiary-avatar">üë®</div>
            <div class="beneficiary-name">Khalid</div>
            <div class="beneficiary-bank">UBA</div>
        </div>
        <div class="beneficiary" onclick="selectBeneficiary('Sarah Johnson', 'GTBank', '0123456789')">
            <div class="beneficiary-avatar">üßë‚Äçü¶≥</div>
            <div class="beneficiary-name">Sarah</div>
            <div class="beneficiary-bank">GTBank</div>
        </div>
        </div>
    <!-- BANK TRANSFER FORM -->
    <div class="form-card" id="bankForm">
        <div class="form-group">
            <label class="form-label">Select Bank</label>
            <select class="form-select" id="bankSelect">
                <option value="">-- Choose Bank --</option>
                <option value="Access Bank">Access Bank</option>
                <option value="GTBank">GTBank</option>
                <option value="UBA">UBA</option>
                <option value="Zenith Bank">Zenith Bank</option>
                <option value="First Bank">First Bank</option>
                <option value="Fidelity Bank">Fidelity Bank</option>
                <option value="Union Bank">Union Bank</option>
                <option value="Wema Bank">Wema Bank</option>
                <option value="Sterling Bank">Sterling Bank</option>
                <option value="OPay">OPay</option>
                <option value="PalmPay">PalmPay</option>
                <option value="Kuda">Kuda</option>
            </select>
        </div>

        <div class="form-group">
            <label class="form-label">Account Number</label>
            <input type="text" class="form-input" id="accountNumber" placeholder="Enter 10-digit account number" maxlength="10">
            <div class="verify-status" id="verifyStatus"></div>
        </div>

        <div class="form-group">
            <label class="form-label">Amount</label>
            <input type="number" class="form-input" id="amount" placeholder="‚Ç¶0" min="100">
        </div>

        <div class="form-group">
            <label class="form-label">Narration (Optional)</label>
            <input type="text" class="form-input" id="narration" placeholder="What's this for?">
        </div>

        <div class="fee-info" id="feeInfo" style="display:none">
            <div class="fee-row">
                <span>Amount</span>
                <span id="feeAmount">‚Ç¶0</span>
            </div>
            <div class="fee-row">
                <span>Transfer Fee</span>
                <span id="feeCharge">‚Ç¶0</span>
            </div>
            <div class="fee-row total">
                <span>Total</span>
                <span id="feeTotal">‚Ç¶0</span>
            </div>
        </div>

        <button class="transfer-btn" id="transferBtn" disabled onclick="showConfirmation()">
            Continue
        </button>
    </div>

    <!-- HAQPAY TRANSFER FORM -->
    <div class="form-card" id="haqpayForm" style="display:none">
        <div class="form-group">
            <label class="form-label">HaqPay Account Number or Phone</label>
            <input type="text" class="form-input" id="haqpayAccount" placeholder="9137109134 or 7084160928">
            <div class="verify-status" id="haqpayVerifyStatus"></div>
        </div>

        <div class="form-group">
            <label class="form-label">Amount</label>
            <input type="number" class="form-input" id="haqpayAmount" placeholder="‚Ç¶0" min="100">
        </div>

        <div class="form-group">
            <label class="form-label">Note (Optional)</label>
            <input type="text" class="form-input" id="haqpayNote" placeholder="Add a note">
        </div>

        <div class="fee-info">
            <div class="fee-row">
                <span>üíö Free HaqPay Transfer</span>
                <span style="color:var(--green);font-weight:700">‚Ç¶0</span>
            </div>
        </div>

        <button class="transfer-btn" id="haqpayTransferBtn" disabled onclick="showConfirmation()">
            Continue
        </button>
    </div>

    <!-- BOTTOM NAV -->
    <nav class="bottom-nav">
        <a href="index.html" class="bn">
            <span class="bn-icon">üè†</span>
            <span>Home</span>
        </a>
        <a href="finance.html" class="bn active">
            <span class="bn-icon">üíº</span>
            <span>Finance</span>
        </a>
        <a href="reward.html" class="bn">
            <span class="bn-icon">üéÅ</span>
            <span>Rewards</span>
        </a>
        <a href="me.html" class="bn">
            <span class="bn-icon">üë§</span>
            <span>Me</span>
        </a>
    </nav>

    <!-- CONFIRMATION MODAL -->
    <div class="modal" id="confirmModal">
        <div class="modal-content">
            <div class="modal-icon">üí∏</div>
            <div class="modal-title">Confirm Transfer</div>
            <div class="modal-text">Please review your transfer details</div>
            <div class="modal-detail" id="confirmDetails"></div>
            <div class="modal-actions">
                <button class="modal-btn secondary" onclick="closeConfirm()">Cancel</button>
                <button class="modal-btn primary" onclick="showPin()">Continue</button>
            </div>
        </div>
    </div>

    <!-- PIN MODAL -->
    <div class="modal" id="pinModal">
        <div class="modal-content">
            <div class="modal-icon">üîê</div>
            <div class="modal-title">Enter PIN</div>
            <div class="modal-text">Enter your 4-digit transaction PIN</div>
            <div class="pin-inputs">
                <input type="password" class="pin-input" maxlength="1" id="pin1">
                <input type="password" class="pin-input" maxlength="1" id="pin2">
                <input type="password" class="pin-input" maxlength="1" id="pin3">
                <input type="password" class="pin-input" maxlength="1" id="pin4">
            </div>
            <div class="modal-actions">
                <button class="modal-btn secondary" onclick="closePin()">Cancel</button>
                <button class="modal-btn primary" onclick="processTransfer()">Confirm</button>
            </div>
        </div>
    </div>

    <!-- SUCCESS MODAL -->
    <div class="modal" id="successModal">
        <div class="modal-content">
            <div class="success-icon">‚úì</div>
            <div class="modal-title">Transfer Successful!</div>
            <div class="modal-text" id="successMessage"></div>
            <div class="modal-detail" id="receiptDetails"></div>
            <div class="modal-actions" style="margin-top:24px">
                <button class="modal-btn secondary" onclick="downloadReceipt()">Download</button>
                <button class="modal-btn primary" onclick="closeSuccess()">Done</button>
            </div>
        </div>
    </div>

    <!-- TOAST -->
    <div class="toast" id="toast">
        <span id="toastMsg"></span>
    </div>
<script>
let transferMode = 'bank';
let verifiedAccount = null;
let transferData = {};

const accountNames = {
    '8012345678': 'Fadipe Precious Oyindamola',
    '2034567890': 'Fashina Khalid Adewale',
    '0123456789': 'Sarah Johnson Temitope',
    '9137109134': 'Haq (HaqPay User)',
    '08012345678': 'John Doe (HaqPay User)'
};

function switchTab(mode) {
    transferMode = mode;
    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
    event.currentTarget.classList.add('active');
    if (mode === 'bank') {
        document.getElementById('bankForm').style.display = 'block';
        document.getElementById('haqpayForm').style.display = 'none';
    } else {
        document.getElementById('bankForm').style.display = 'none';
        document.getElementById('haqpayForm').style.display = 'block';
    }
}

function selectBeneficiary(name, bank, account) {
    if (transferMode === 'bank') {
        document.getElementById('bankSelect').value = bank;
        document.getElementById('accountNumber').value = account;
        verifyAccount();
    }
    showToast(`‚úÖ ${name} selected`);
}

let verifyTimeout;
document.getElementById('accountNumber').addEventListener('input', () => {
    clearTimeout(verifyTimeout);
    const account = document.getElementById('accountNumber').value;
    const bank = document.getElementById('bankSelect').value;
    if (account.length === 10 && bank) {
        document.getElementById('verifyStatus').className = 'verify-status loading';
        document.getElementById('verifyStatus').textContent = '‚è≥ Verifying account...';
        verifyTimeout = setTimeout(() => verifyAccount(), 1500);
    } else {
        document.getElementById('verifyStatus').style.display = 'none';
        verifiedAccount = null;
    }
    updateTransferButton();
});

function verifyAccount() {
    const account = document.getElementById('accountNumber').value;
    const bank = document.getElementById('bankSelect').value;
    if (accountNames[account]) {
        verifiedAccount = {name: accountNames[account], bank: bank, account: account};
        document.getElementById('verifyStatus').className = 'verify-status success';
        document.getElementById('verifyStatus').innerHTML = `‚úì <span class="account-name">${accountNames[account]}</span>`;
    } else {
        document.getElementById('verifyStatus').className = 'verify-status error';
        document.getElementById('verifyStatus').textContent = '‚ùå Account not found';
        verifiedAccount = null;
    }
    updateTransferButton();
}

document.getElementById('bankSelect').addEventListener('change', () => {
    const account = document.getElementById('accountNumber').value;
    if (account.length === 10) verifyAccount();
});

document.getElementById('amount').addEventListener('input', () => {
    const amount = parseFloat(document.getElementById('amount').value) || 0;
    if (amount >= 100) {
        const fee = amount > 5000 ? 26.88 : 10.75;
        const total = amount + fee;
        document.getElementById('feeAmount').textContent = `‚Ç¶${amount.toLocaleString()}`;
        document.getElementById('feeCharge').textContent = `‚Ç¶${fee.toFixed(2)}`;
        document.getElementById('feeTotal').textContent = `‚Ç¶${total.toLocaleString(undefined, {minimumFractionDigits: 2})}`;
        document.getElementById('feeInfo').style.display = 'block';
    } else {
        document.getElementById('feeInfo').style.display = 'none';
    }
    updateTransferButton();
});

document.getElementById('haqpayAccount').addEventListener('input', () => {
    clearTimeout(verifyTimeout);
    const account = document.getElementById('haqpayAccount').value;
    if (account.length >= 10) {
        document.getElementById('haqpayVerifyStatus').className = 'verify-status loading';
        document.getElementById('haqpayVerifyStatus').textContent = '‚è≥ Verifying...';
        verifyTimeout = setTimeout(() => {
            if (accountNames[account]) {
                verifiedAccount = {name: accountNames[account], account: account};
                document.getElementById('haqpayVerifyStatus').className = 'verify-status success';
                document.getElementById('haqpayVerifyStatus').innerHTML = `‚úì <span class="account-name">${accountNames[account]}</span>`;
            } else {
                document.getElementById('haqpayVerifyStatus').className = 'verify-status error';
                document.getElementById('haqpayVerifyStatus').textContent = '‚ùå User not found';
                verifiedAccount = null;
            }
            updateTransferButton();
        }, 1500);
    } else {
        document.getElementById('haqpayVerifyStatus').style.display = 'none';
        verifiedAccount = null;
    }
    updateTransferButton();
});

document.getElementById('haqpayAmount').addEventListener('input', updateTransferButton);

function updateTransferButton() {
    if (transferMode === 'bank') {
        const btn = document.getElementById('transferBtn');
        const amount = parseFloat(document.getElementById('amount').value) || 0;
        btn.disabled = !(verifiedAccount && amount >= 100);
    } else {
        const btn = document.getElementById('haqpayTransferBtn');
        const amount = parseFloat(document.getElementById('haqpayAmount').value) || 0;
        btn.disabled = !(verifiedAccount && amount >= 100);
    }
}

function showConfirmation() {
    if (transferMode === 'bank') {
        const amount = parseFloat(document.getElementById('amount').value);
        const fee = amount > 5000 ? 26.88 : 10.75;
        const total = amount + fee;
        const narration = document.getElementById('narration').value || 'Transfer';
        transferData = {type: 'bank', recipient: verifiedAccount.name, bank: verifiedAccount.bank, account: verifiedAccount.account, amount: amount, fee: fee, total: total, narration: narration};
        document.getElementById('confirmDetails').innerHTML = `
            <div class="detail-row"><span class="detail-label">To</span><span class="detail-value">${verifiedAccount.name}</span></div>
            <div class="detail-row"><span class="detail-label">Bank</span><span class="detail-value">${verifiedAccount.bank}</span></div>
            <div class="detail-row"><span class="detail-label">Account</span><span class="detail-value">${verifiedAccount.account}</span></div>
            <div class="detail-row"><span class="detail-label">Amount</span><span class="detail-value">‚Ç¶${amount.toLocaleString()}</span></div>
            <div class="detail-row"><span class="detail-label">Fee</span><span class="detail-value">‚Ç¶${fee.toFixed(2)}</span></div>
            <div class="detail-row total"><span class="detail-label">Total</span><span class="detail-value" style="color:var(--green)">‚Ç¶${total.toLocaleString(undefined, {minimumFractionDigits: 2})}</span></div>
        `;
    } else {
        const amount = parseFloat(document.getElementById('haqpayAmount').value);
        const note = document.getElementById('haqpayNote').value || 'HaqPay Transfer';
        transferData = {type: 'haqpay', recipient: verifiedAccount.name, account: verifiedAccount.account, amount: amount, fee: 0, total: amount, note: note};
        document.getElementById('confirmDetails').innerHTML = `
            <div class="detail-row"><span class="detail-label">To</span><span class="detail-value">${verifiedAccount.name}</span></div>
            <div class="detail-row"><span class="detail-label">HaqPay Account</span><span class="detail-value">${verifiedAccount.account}</span></div>
            <div class="detail-row"><span class="detail-label">Amount</span><span class="detail-value" style="color:var(--green)">‚Ç¶${amount.toLocaleString()}</span></div>
            <div class="detail-row"><span class="detail-label">Fee</span><span class="detail-value" style="color:var(--green)">FREE</span></div>
        `;
    }
    document.getElementById('confirmModal').classList.add('show');
}

function closeConfirm() {
    document.getElementById('confirmModal').classList.remove('show');
}

function showPin() {
    closeConfirm();
    document.getElementById('pinModal').classList.add('show');
    setTimeout(() => document.getElementById('pin1').focus(), 300);
}

function closePin() {
    document.getElementById('pinModal').classList.remove('show');
    document.querySelectorAll('.pin-input').forEach(input => input.value = '');
}

document.querySelectorAll('.pin-input').forEach((input, index) => {
    input.addEventListener('input', (e) => {
        if (e.target.value.length === 1 && index < 3) {
            document.getElementById(`pin${index + 2}`).focus();
        }
    });
    input.addEventListener('keydown', (e) => {
        if (e.key === 'Backspace' && !e.target.value && index > 0) {
            document.getElementById(`pin${index}`).focus();
        }
    });
});

function processTransfer() {
    const pin = document.getElementById('pin1').value + document.getElementById('pin2').value + document.getElementById('pin3').value + document.getElementById('pin4').value;
    if (pin.length !== 4) {
        showToast('‚ùå Please enter complete PIN');
        return;
    }
    if (pin !== '1234') {
        showToast('‚ùå Invalid PIN. Try 1234');
        return;
    }
    closePin();
    showToast('‚è≥ Processing transfer...');
    setTimeout(() => {
        const ref = 'TRF' + Date.now().toString().slice(-8);
        const date = new Date().toLocaleString();
        document.getElementById('successMessage').innerHTML = `‚Ç¶${transferData.amount.toLocaleString()} sent to <b>${transferData.recipient}</b>`;
        document.getElementById('receiptDetails').innerHTML = `
            <div class="detail-row"><span class="detail-label">Reference</span><span class="detail-value">${ref}</span></div>
            <div class="detail-row"><span class="detail-label">Date</span><span class="detail-value">${date}</span></div>
            <div class="detail-row"><span class="detail-label">Status</span><span class="detail-value" style="color:var(--green)">‚úì Successful</span></div>
        `;
        document.getElementById('successModal').classList.add('show');
    }, 2000);
}

function downloadReceipt() {
    showToast('üìÑ Receipt downloaded');
}

function closeSuccess() {
    document.getElementById('successModal').classList.remove('show');
    window.location.href = 'index.html';
}

document.getElementById('backBtn').addEventListener('click', () => {
    window.location.href = 'finance.html';
});

document.getElementById('historyBtn').addEventListener('click', () => {
    window.location.href = 'history.html';
});

function showToast(message) {
    const toast = document.getElementById('toast');
    const toastMsg = document.getElementById('toastMsg');
    toastMsg.textContent = message;
    toast.classList.add('show');
    setTimeout(() => {
        toast.classList.remove('show');
    }, 3000);
}

document.querySelectorAll('.modal').forEach(modal => {
    modal.addEventListener('click', (e) => {
        if (e.target === modal) {
            modal.classList.remove('show');
        }
    });
});

let darkMode = localStorage.getItem('darkMode') === 'true';
if(darkMode) document.body.classList.add('dark');
</script>
    